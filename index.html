<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>미미로또방</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: 'Arial', sans-serif;
      background: radial-gradient(circle at top, #ffeaa7, #fab1a0, #d980fa);
      animation: bgPulse 5s infinite alternate;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding-bottom: 80px;
      overflow-x: hidden;
      position: relative;
    }

    @keyframes bgPulse {
      0% { background-position: 0% 50%; filter: brightness(1); }
      100% { background-position: 100% 50%; filter: brightness(1.2); }
    }

    header {
      margin-top: 20px;
      animation: fadeIn 1s ease;
      z-index: 1;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    img {
      width: 180px;
      height: auto;
    }

    .container {
      width: 100%;
      max-width: 600px;
      padding: 0 20px;
      box-sizing: border-box;
    }

    .buttons {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 10px;
      margin: 30px auto 10px;
      z-index: 1;
    }

    .buttons button {
      padding: 10px 15px;
      border: none;
      color: white;
      font-weight: bold;
      border-radius: 10px;
      cursor: pointer;
      font-size: 16px;
      box-shadow: 0 3px 8px rgba(0,0,0,0.2);
      transition: transform 0.2s, box-shadow 0.2s;
    }

    .buttons button:active {
      transform: scale(1.1);
      box-shadow: 0 0 20px #fff;
    }

    .regular { background-color: #d63031; }
    .analysis { background-color: #0984e3; }
    .ai { background-color: #00b894; }

    .ball-container {
      display: flex;
      justify-content: center;
      margin: 20px auto;
      gap: 10px;
      flex-wrap: wrap;
      z-index: 1;
    }

    .ball {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      color: white;
      font-size: 18px;
      animation: spinIn 1s ease;
      box-shadow: 0 2px 5px rgba(0,0,0,0.3);
    }

    @keyframes spinIn {
      0% { transform: rotate(0deg) scale(0); opacity: 0; }
      100% { transform: rotate(360deg) scale(1); opacity: 1; }
    }

    .select-actions {
      display: flex;
      justify-content: space-between;
      align-items: center;
      width: 100%;
      margin: 10px 0;
      z-index: 1;
    }

    .select-actions button {
      padding: 5px 10px;
      font-size: 14px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      background-color: #636e72;
      color: white;
    }

    .history {
      width: 100%;
      z-index: 1;
    }

    .history-item {
      background: white;
      margin-bottom: 10px;
      padding: 10px;
      border-radius: 10px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      animation: fadeIn 0.5s ease;
    }

    .history-top {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 14px;
      margin-bottom: 5px;
    }

    .history-balls {
      display: flex;
      align-items: center;
      gap: 5px;
      flex-wrap: wrap;
    }

    .history-balls .ball {
      width: 30px;
      height: 30px;
      font-size: 14px;
      animation: none;
    }

    .delete-btn {
      background: #ccc;
      border: none;
      padding: 5px 10px;
      border-radius: 5px;
      font-size: 12px;
      cursor: pointer;
    }

    .checkbox {
      margin-right: 5px;
    }

    .flash {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(255,255,255,0.6);
      z-index: 99;
      animation: flashBang 0.4s ease;
      pointer-events: none;
    }

    @keyframes flashBang {
      0% { opacity: 0; }
      50% { opacity: 1; }
      100% { opacity: 0; }
    }

    .particles {
      position: fixed;
      top: 0; left: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
      z-index: 0;
      pointer-events: none;
    }

    .particles .lotto {
      position: absolute;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      font-weight: bold;
      color: white;
      animation: fallRotate linear infinite;
    }

    @keyframes fallRotate {
      0% {
        transform: translateY(-50px) rotate(0deg) scale(0.5);
        opacity: 0.7;
      }
      100% {
        transform: translateY(110vh) rotate(360deg) scale(1);
        opacity: 0;
      }
    }
  </style>
</head>
<body>
  <audio autoplay loop>
    <source src="https://raw.githubusercontent.com/pageno/Mimi/main/%EB%AF%B8%EB%AF%B8%EB%A1%9C%EB%98%90%EB%B0%A9.mp3" type="audio/mpeg">
  </audio>

  <div class="particles" id="particles"></div>

  <header>
    <img src="https://raw.githubusercontent.com/pageno/Mimi/main/mimilogo.png" alt="미미로또방 로고">
  </header>

  <div class="container">
    <div class="buttons">
      <button class="regular" onclick="drawNumbers('일반', '#d63031')">일반 뽑기</button>
      <button class="analysis" onclick="drawNumbers('분석', '#0984e3')">분석 뽑기</button>
      <button class="ai" onclick="drawNumbers('AI', '#00b894')">AI 뽑기</button>
    </div>

    <div class="ball-container" id="balls"></div>

    <div class="select-actions">
      <label><input type="checkbox" id="selectAll" onchange="toggleAll(this)"> 전체 선택</label>
      <button onclick="deleteSelected()">전체 삭제</button>
    </div>

    <div class="history" id="history"></div>
  </div>

  <script>
    let drawing = false;

    function drawNumbers(type, flashColor = "#fff") {
      if (drawing) return;
      drawing = true;

      const flash = document.createElement('div');
      flash.className = 'flash';
      flash.style.background = flashColor + 'AA';
      document.body.appendChild(flash);
      setTimeout(() => flash.remove(), 500);

      const numbers = new Set();
      while (numbers.size < 6) {
        numbers.add(Math.floor(Math.random() * 45) + 1);
      }
      const result = [...numbers].sort((a, b) => a - b);

      const container = document.getElementById('balls');
      container.innerHTML = '';

      result.forEach((num, i) => {
        setTimeout(() => {
          const ball = document.createElement('div');
          ball.className = 'ball';
          ball.textContent = num;
          ball.style.background = getColor(num);
          container.appendChild(ball);
          if (i === result.length - 1) {
            setTimeout(() => {
              saveHistory(result, type);
              drawing = false;
            }, 500);
          }
        }, i * 400);
      });
    }

    function getColor(num) {
      if (num <= 10) return '#fbc531';
      if (num <= 20) return '#00a8ff';
      if (num <= 30) return '#e84118';
      if (num <= 40) return '#9c88ff';
      return '#4cd137';
    }

    function saveHistory(numbers, type) {
      const history = document.getElementById('history');
      const item = document.createElement('div');
      item.className = 'history-item';

      const now = new Date();
      const label = `${now.toLocaleDateString()} ${now.toLocaleTimeString()} (${type})`;

      const top = document.createElement('div');
      top.className = 'history-top';

      const left = document.createElement('div');
      const checkbox = document.createElement('input');
      checkbox.type = 'checkbox';
      checkbox.className = 'checkbox';
      left.appendChild(checkbox);
      left.appendChild(document.createTextNode(label));

      const delBtn = document.createElement('button');
      delBtn.className = 'delete-btn';
      delBtn.textContent = '삭제';
      delBtn.onclick = () => history.removeChild(item);

      top.appendChild(left);
      top.appendChild(delBtn);

      const balls = document.createElement('div');
      balls.className = 'history-balls';
      numbers.forEach(n => {
        const b = document.createElement('div');
        b.className = 'ball';
        b.textContent = n;
        b.style.background = getColor(n);
        balls.appendChild(b);
      });

      item.appendChild(top);
      item.appendChild(balls);
      history.insertBefore(item, history.firstChild);
    }

    function toggleAll(source) {
      document.querySelectorAll('.checkbox').forEach(cb => cb.checked = source.checked);
    }

    function deleteSelected() {
      document.querySelectorAll('.checkbox:checked').forEach(cb => {
        const item = cb.closest('.history-item');
        if (item) item.remove();
      });
    }

    function generateParticles() {
      const particleArea = document.getElementById('particles');
      for (let i = 0; i < 40; i++) {
        const lotto = document.createElement('div');
        lotto.className = 'lotto';

        const num = Math.floor(Math.random() * 45) + 1;
        lotto.textContent = num;
        lotto.style.background = getColor(num);
        lotto.style.left = Math.random() * 100 + 'vw';
        lotto.style.animationDuration = (Math.random() * 5 + 5) + 's';
        lotto.style.animationDelay = (Math.random() * 10) + 's';
        particleArea.appendChild(lotto);
      }
    }

    window.onload = () => {
      generateParticles();
      setInterval(generateParticles, 8000);
    }
  </script>
</body>
</html>
